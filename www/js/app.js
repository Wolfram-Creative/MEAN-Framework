/*! MEAN-Framework 2014-01-29 Created with MEAN stack by Wolfram Creative http://woflframcreative.com */
var app=angular.module("app",["ngRoute",function(){"use strict"}]);app.run(["$rootScope","_$local",function(a,b){"use strict";var c=b.get("user");a.appTitle="MEAN",angular.isObject(c)&&Object.keys(c).length&&(a.user=c,a.logged_in=!0)}]),app.config(["$routeProvider","$locationProvider",function(a,b){"use strict";b.html5Mode(!0),a.when("/",{templateUrl:"/src/app/views/home.ng",controller:"HomeController"}).when("/login",{templateUrl:"/src/app/views/login.ng",controller:"LoginController"}).when("/register",{templateUrl:"/src/app/views/register.ng",controller:"LoginController"}),a.otherwise({redirectTo:"/"})}]),app.controller("HeaderController",["$scope","$rootScope","$location","AuthenticationService","apiCall","_$local",function(a,b,c,d,e,f){"use strict";a.root=b,a.logOut=function(){f.remove("user"),b.user={},b.logged_in=!1}}]),app.controller("HomeController",["$scope","$rootScope","$location","AuthenticationService","apiCall",function(a,b){"use strict";a.root=b,b.title="Welcome"}]),app.controller("LoginController",["$rootScope","$routeParams","$scope","$location","apiCall","_$local",function(a,b,c,d,e,f){"use strict";a.title="Log In",c.root=a,a.logged_in&&d.path("/"),c.loginUser=function(){e.logIn(c.credentials).then(function(b){var c=b.data;if(c.success){var e=c.body;f.set("user",e),a.user=e,a.logged_in=!0,d.path("/")}})},c.createUser=function(){e.createUser(c.new_user).then(function(b){var c=b.data;if(c.success){var e=c.body;f.set("user",e),a.user=e,a.logged_in=!0,d.path("/")}})}}]),app.directive("integer",function(){var a=/^\-?\d+$/;return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){return a.test(b)?(e.$setValidity("integer",!0),b):void e.$setValidity("integer",!1)})}}}),app.directive("smartFloat",function(){var a=/^\-?\d+((\.|\,)\d+)?$/;return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){return a.test(b)?(e.$setValidity("float",!0),parseFloat(b.replace(",","."))):void e.$setValidity("float",!1)})}}}),app.directive("ngHeader",function(){"use strict";return{restrict:"A",templateUrl:"/src/app/views/header.ng",controller:"HeaderController"}}),app.directive("scrollPosition",["$window",function(a){return{scope:{scroll:"=scrollPosition"},link:function(b){var c=angular.element(a),d=function(){b.scroll=c.scrollTop()};c.on("scroll",b.$apply.bind(b,d)),d()}}}]),app.factory("apiCall",["$http",function(a){"use strict";return{createUser:function(b){return a.post("/api/users/create/",b)},logIn:function(b){return console.log(b),a.post("/api/users/log_in/",b)}}}]),app.factory("AuthenticationService",["$location",function(a){"use strict";return{login:function(b){"ralph"!==b.username||"wiggum"!==b.password?alert("Username must be 'ralph', password must be 'wiggum'"):a.path("/")},logout:function(){a.path("/login")}}}]),app.factory("_$local",[function(){"use strict";return{set:function(a,b){return localStorage.setItem(a,JSON.stringify(b)),b},get:function(a){var b={};return"undefined"!==localStorage.getItem(a)&&(b=JSON.parse(localStorage.getItem(a))),b},clear:function(){return localStorage.clear(),this},remove:function(a){return localStorage.removeItem(a),this}}}]);